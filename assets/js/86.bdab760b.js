(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{552:function(e,a,o){"use strict";o.r(a);var s=o(6),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,o=e._self._c||a;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"uso-de-claves-ssh-con-git-y-su-configuracion-en-bitbucket-sourcetree-github-y-vscode"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#uso-de-claves-ssh-con-git-y-su-configuracion-en-bitbucket-sourcetree-github-y-vscode"}},[e._v("#")]),e._v(" Uso de claves SSH con Git y su configuración en BitBucket, Sourcetree, GitHub y VSCode")]),e._v(" "),o("social-share",{staticClass:"social-share--header"}),e._v(" "),o("p",[e._v("Cuando nos conectamos a un repositorio Git remoto, solemos tener dos opciones de conexión, HTTPS y SSH. Con HTTPS la comunicación se realiza mediante una capa segura que cifra la comunicación HTTP entre el cliente y servidor ("),o("em",[e._v("HTTPS = HTTP + SSL/TLS")]),e._v("), sin embargo, SSH es un canal de comunicación seguro que se establece entre dos máquinas y que permite el acceso remoto a un servidor para el intercambio cifrado de información o para la ejecución remota de comandos.")]),e._v(" "),o("p",[e._v("Para conectarnos a un repositorio Git privado mediante HTTPS usaríamos la clásica autenticación con contraseña y que nos permitiría conectarnos a un servidor Git desde cualquier ubicación simplemente usando nuestro usuario y contraseña. Ciertamente es un protocolo fácil de configurar y de usar en la mayoría de plataformas y redes.")]),e._v(" "),o("p",[e._v("En el caso de la conexión y autenticación a Git basada en claves SSH, la conexión entre el cliente y el servidor se produce por la coincidencia del par de claves (pública y privada), una usada por el cliente (la clave privada) y la otra por el servidor (la clave pública), para establecer un canal seguro de comunicación en el que toda la información está cifrada. Podríamos ver a la clave pública como un candado y a la clave privada como la llave que lo abre (ambos elementos generados por nosotros), por lo que nosotros otorgamos con la clave pública que cualquiera pueda bloquear la información que posteriormente nosotros abriremos con la clave privada (nuestra llave).")]),e._v(" "),o("p",[e._v("Realmente ambos protocolos harán bien su trabajo de guardar a salvo la información intercambiada, siempre y cuando las claves estén bien protegidas, por lo que tanto HTTPS como SSH proporcionan una conexión segura a salvo de ataques de intermediarios. A pesar de ello, me gustaría destacar algunos aspectos diferenciadores en cuanto la seguridad de ambos protocolos:")]),e._v(" "),o("ul",[o("li",[e._v("En el caso de HTTPS con Git, la contraseña será parte del mensaje enviado al servidor, sin embargo con SSH la clave privada no se envia al servidor y sólo se usa por parte del cliente para la autenticación durante la fase de creación del canal seguro de comunicación.")]),e._v(" "),o("li",[e._v("En el caso de SSH, la propia longitud de la clave, su unicidad y la dificulad de su manejo, la hacen generalmente más segura, sin embargo tiene el inconveniente de que se almacena físicamente como un archivo en el disco. De todos modos como veremos más adelante durante los pasos de cómo crear nuestras claves SSH, podremos proteger la clave privada con una frase de seguridad.")]),e._v(" "),o("li",[e._v("Con ambos protocolos podemos usar 2FA (doble factor de autenticación), aunque según la plataforma puede ser más sencillo su uso según el protocolo elegido.")])]),e._v(" "),o("h2",{attrs:{id:"¿como-crear-claves-ssh"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#¿como-crear-claves-ssh"}},[e._v("#")]),e._v(" ¿Cómo crear claves SSH?")]),e._v(" "),o("p",[e._v("Las claves SSH son generadas automáticamente mediante herramientas a partir de algoritmos criptográficos y fórmulas matemáticas que garantizan su seguridad y que además la clave pública derive de la clave privada.")]),e._v(" "),o("p",[e._v("Tanto Linux como OsX cuentan con terminales que incluyen la suite SSH, sin embargo en el caso de Windows debemos hacer uso de opciones tales como "),o("em",[e._v("Git Bash")]),e._v(".")]),e._v(" "),o("h3",{attrs:{id:"ssh-keygen"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#ssh-keygen"}},[e._v("#")]),e._v(" ssh-keygen")]),e._v(" "),o("ol",[o("li",[e._v("En primer lugar, desde nuestra terminal (Mac/Linux) o Git Bash (Windows) ejecutamos el siguiente comando:")])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("ssh-keygen -t rsa -b "),o("span",{pre:!0,attrs:{class:"token number"}},[e._v("4096")]),e._v(" -C "),o("span",{pre:!0,attrs:{class:"token string"}},[e._v('"tu@email.com"')]),e._v("\n")])])]),o("ol",{attrs:{start:"2"}},[o("li",[e._v('A continuación se nos preguntará por el nombre del fichero donde queremos guardar nuestra clave. Podemos simplemente pulsar "Intro" para usar el nombre por defecto '),o("em",[e._v("id_rsa")]),e._v(' o también podemos especificar uno manualmente y pulsar "Intro".')])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("Enter "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("file")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("which")]),e._v(" to save the key "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("/c/Users/rafaelneto/.ssh/id_rsa"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(":\n")])])]),o("ol",{attrs:{start:"3"}},[o("li",[e._v('El siguiente mensaje nos preguntará por la frase de seguridad, la cual protegerá nuestra clave si alguien accede a la máquina donde hemos almacenado nuestra clave privada. Podríamos simplemente pulsar "Intro" sin introducir la frase de seguridad para omitir este paso, pero dada la importancia de la clave privada, no deberíamos omitir esa capa de seguridad añadida.')])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("Enter passphrase "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("empty "),o("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" no passphrase"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(":\n")])])]),o("p",[e._v("En este punto nuestras claves SSH se habrán generado en dos ficheros, en la ruta que habíamos especificado. Uno de ellos contendrá nuestra clave privada a partir del nombre que hayamos especificado en el paso "),o("em",[e._v("2.")]),e._v(" y otro (con el mismo nombre pero con extensión "),o("em",[e._v(".pub")]),e._v(") contendrá nuestra clave pública.")]),e._v(" "),o("h3",{attrs:{id:"ssh-agent"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#ssh-agent"}},[e._v("#")]),e._v(" ssh-agent")]),e._v(" "),o("p",[e._v("El programa "),o("em",[e._v("ssh-agent")]),e._v(" es el encargado de almacenar y gestionar las claves privadas durante las conexiones, por lo que si no queremos tener que escribir nuestra frase de seguridad cada vez que usemos nuestra clave SSH, debemos hacer uso de él.")]),e._v(" "),o("ol",[o("li",[e._v("Comprobamos que el agente se está ejecutando (y lo arrancamos si no lo estuviera):")])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[o("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("eval")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),o("span",{pre:!0,attrs:{class:"token variable"}},[o("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("ssh-agent -s"),o("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v('"')]),e._v("\n")])])]),o("p",[e._v("Tendremos como respuesta el identificador del proceso:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("Agent pid "),o("span",{pre:!0,attrs:{class:"token number"}},[e._v("445")]),e._v("\n")])])]),o("blockquote",[o("p",[e._v("Para asegurarnos de que el servicio "),o("em",[e._v("ssh-agent")]),e._v(" arranque de forma automática en Windows, debemos ejecutar el siguiente comando desde PowerShell como administrador "),o("code",[e._v("Get-Service ssh-agent | Set-Service -StartupType Automatic")]),e._v(".")])]),e._v(" "),o("ol",{attrs:{start:"2"}},[o("li",[e._v("Añadimos nuestra clave al agente SSH:")])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("ssh-add /c/Users/rafaelneto/.ssh/id_rsa\n")])])]),o("p",[e._v("Si durante la creación de la clave privada hubiéramos establecido una frase de seguridad, en este paso se nos solicitará que la introduzcamos.")]),e._v(" "),o("blockquote",[o("p",[o("em",[e._v("¿Tenemos "),o("em",[e._v("ssh-agent")]),e._v(" arrancado pero VSCode en Windows siempre nos solicita la frase de seguridad?")]),e._v(" En algunos escenarios podemos encontrarnos con que aunque tengamos el "),o("em",[e._v("ssh-agent")]),e._v(" arrancado, siempre se nos solicite la frase de seguridad al trabajar por ejemplo con VSCode en Windows. En ese caso, muy probablemente el problema resida en que Git no sabe cómo comunicarse con el servicio "),o("em",[e._v("ssh-agent")]),e._v(" de Windows y para ello debemos informar a Git de la ruta OpenSSH del sistema mediante la variable de entorno "),o("em",[e._v("GIT_SSH")]),e._v(", ejecutando el siguiente comando desde PowerShell como administrador "),o("code",[e._v('[Environment]::SetEnvironmentVariable("GIT_SSH", "$((Get-Command ssh).Source)", [System.EnvironmentVariableTarget]::User)')]),e._v(" y cerrando todas los terminales e instancias de VSCode abiertos en nuestro sistema. A partir de ese momento, la próxima vez que usemos VSCode, ya no se nos solicitará la frase de seguridad.")])]),e._v(" "),o("h2",{attrs:{id:"configuracion-de-claves-ssh-en-bitbucket"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#configuracion-de-claves-ssh-en-bitbucket"}},[e._v("#")]),e._v(" Configuración de claves SSH en Bitbucket")]),e._v(" "),o("p",[e._v("Para hacer uso de SSH con Bitbucket, en primer lugar debemos añadir nuestra clave pública a nuestro perfil de Bitbucket, para ello:")]),e._v(" "),o("ol",[o("li",[e._v("Accedemos a nuestra configuración personal ("),o("em",[e._v("Personal Bitbucket Settings")]),e._v(").")]),e._v(" "),o("li",[e._v("Clicamos en la opción de seguridad "),o("em",[e._v("SSH keys")]),e._v(". Si ya tenemos claves añadidas, las veremos en esta pantalla.")]),e._v(" "),o("li",[e._v("Abrimos nuestro fichero "),o("em",[e._v(".ssh/id_rsa.pub")]),e._v(" (o con el nombre que le hayamos indicado para el fichero de la clave pública).")]),e._v(" "),o("li",[e._v("Copiamos el contenido del fichero de la clave pública (es posible que veamos nuestro email en la última línea del fichero, con lo que no importa si copiamos o no dicha línea).")]),e._v(" "),o("li",[e._v("Desde el panel de Bitbucket pulsamos en "),o("em",[e._v("Add key")]),e._v(".")]),e._v(" "),o("li",[e._v("Introducimos una etiqueta ("),o("em",[e._v("Label")]),e._v(") para nuestra nueva clave.")]),e._v(" "),o("li",[e._v("Pegamos la clave pública copiada en el campo "),o("em",[e._v("Key")]),e._v(".")]),e._v(" "),o("li",[e._v("Pulsamos en "),o("em",[e._v("Add key")]),e._v(" para guardar los cambios.")]),e._v(" "),o("li",[e._v("Bitbucket nos enviará un email para avisarnos sobre la adicción de la nueva clave.")])]),e._v(" "),o("p",[e._v("En este punto ya podemos volver a nuestra línea de comandos y verificar nuestra configuración mediante el siguiente comando:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[o("span",{pre:!0,attrs:{class:"token function"}},[e._v("ssh")]),e._v(" -T git@bitbucket.org\n")])])]),o("p",[e._v("Se nos mostrará un mensage del tipo "),o("em",[e._v("You can use git to connect to Bitbucket.")]),e._v(", que nos indica que ya nos podemos conectar a Bitbucket con dicha clave.")]),e._v(" "),o("p",[e._v("Ahora ya tenemos nuestra clave SSH configurada, así que la próxima vez que clonemos un repositorio de Bitbucket deberemos hacer uso de la URL SSH. Si ya tenemos un repositorio clonado previamente a través de HTTPS, debemos cambiar la URL remota de nuestro repositorio a la URL SSH.")]),e._v(" "),o("h2",{attrs:{id:"configuracion-de-claves-ssh-en-github"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#configuracion-de-claves-ssh-en-github"}},[e._v("#")]),e._v(" Configuración de claves SSH en GitHub")]),e._v(" "),o("p",[e._v("Para hacer uso de SSH con GitHub, en primer lugar debemos añadir nuestra clave pública a nuestro perfil de GitHub, para ello:")]),e._v(" "),o("ol",[o("li",[e._v("Accedemos a nuestra configuración personal ("),o("em",[e._v("Settings")]),e._v(").")]),e._v(" "),o("li",[e._v("Clicamos en la opción de acceso "),o("em",[e._v("SSH and GPG keys")]),e._v(". Si ya tenemos claves añadidas, las veremos en esta pantalla.")]),e._v(" "),o("li",[e._v("Abrimos nuestro fichero "),o("em",[e._v(".ssh/id_rsa.pub")]),e._v(" (o con el nombre que le hayamos indicado para el fichero de la clave pública).")]),e._v(" "),o("li",[e._v("Copiamos el contenido del fichero de la clave pública (es posible que veamos nuestro email en la última línea del fichero, con lo que no importa si copiamos o no dicha línea).")]),e._v(" "),o("li",[e._v("Desde el panel de GitHub pulsamos en "),o("em",[e._v("New SSH key")]),e._v(".")]),e._v(" "),o("li",[e._v("Introducimos un título ("),o("em",[e._v("Title")]),e._v(") para nuestra nueva clave.")]),e._v(" "),o("li",[e._v("Seleccionamos el tipo de uso de la clave para autenticación ("),o("em",[e._v("Authentication Key")]),e._v(").")]),e._v(" "),o("li",[e._v("Pegamos la clave pública copiada en el campo "),o("em",[e._v("Key")]),e._v(".")]),e._v(" "),o("li",[e._v("Pulsamos en "),o("em",[e._v("Add SSH key")]),e._v(" para guardar los cambios.")]),e._v(" "),o("li",[e._v("GitHub nos enviará un email para avisarnos sobre la adicción de la nueva clave pública.")])]),e._v(" "),o("p",[e._v("En este punto ya podemos volver a nuestra línea de comandos y verificar nuestra configuración mediante el siguiente comando:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[o("span",{pre:!0,attrs:{class:"token function"}},[e._v("ssh")]),e._v(" -T git@github.com\n")])])]),o("p",[e._v("Es posible que veamos algún mensaje de aviso del tipo "),o("em",[e._v("The authenticity of host 'github.com (IP)' can't be established. ED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF/zLDA0zPMSvHdkr4UvCOqU. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])?")]),e._v(".")]),e._v(" "),o("p",[e._v("Al aceptar la conexión, finalmente se nos mostrará un mensage del tipo "),o("em",[e._v("Warning: Permanently added 'github.com' (ED25519) to the list of known hosts. Hi USER! You've successfully authenticated, but GitHub does not provide shell access.")]),e._v(", que nos indica que ya nos podemos conectar a GitHub con dicha clave.")]),e._v(" "),o("p",[e._v("Ahora ya tenemos nuestra clave SSH configurada, así que la próxima vez que clonemos un repositorio de GitHub deberemos hacer uso de la URL SSH. Si ya tenemos un repositorio clonado previamente a través de HTTPS, debemos cambiar la URL remota de nuestro repositorio a la URL SSH.")]),e._v(" "),o("h3",{attrs:{id:"cambiar-la-url-remota-de-un-repositorio-de-bitbucket-clonado-con-https-a-ssh"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cambiar-la-url-remota-de-un-repositorio-de-bitbucket-clonado-con-https-a-ssh"}},[e._v("#")]),e._v(" Cambiar la URL remota de un repositorio de Bitbucket clonado con HTTPS a SSH")]),e._v(" "),o("p",[e._v("Para cambiar la URL remota de un repositorio clonado con HTTPS a SSH, debemos seguir los siguientes pasos:")]),e._v(" "),o("ol",[o("li",[e._v("Obtenemos la URL SSH del repositorio:\n"),o("ol",[o("li",[e._v("En "),o("strong",[e._v("Bitbucket")]),e._v(":\n"),o("ol",[o("li",[e._v('En la página del repositorio en Bitbucket hacemos clic en el botón "Clone" en la parte superior derecha.')]),e._v(" "),o("li",[e._v('Seleccionamos "SSH" en el menú desplegable.')]),e._v(" "),o("li",[e._v("Copiamos la URL que aparece en la ventana de diálogo. Debemos obviar la primera parte del comando "),o("em",[e._v("git clone")]),e._v(" y sólo copiar a partir de "),o("em",[e._v("git@bitbucket...")])])])]),e._v(" "),o("li",[e._v("En "),o("strong",[e._v("GitHub")]),e._v(":\n"),o("ol",[o("li",[e._v('En la página del repositorio en GitHub hacemos clic en el botón "<> Code" en la parte superior derecha del panel central.')]),e._v(" "),o("li",[e._v('Seleccionamos la pestaña "SSH".')]),e._v(" "),o("li",[e._v("Copiamos la URL que aparece en la ventana de diálogo. Nuestra URL empezará con "),o("em",[e._v("git@github...")])])])])])]),e._v(" "),o("li",[e._v("Cambiamos la URL remota:\n"),o("ol",[o("li",[e._v("Abrimos la línea de comandos y navegamos hasta el directorio del repositorio Git que deseamos actualizar.")]),e._v(" "),o("li",[e._v("Ejecutamos el siguiente comando para cambiar la URL remota del repositorio de HTTPS a SSH: "),o("code",[e._v("git remote set-url origin <la URL SSH copiada>")])])])]),e._v(" "),o("li",[e._v("Verificamos la configuración:\n"),o("ol",[o("li",[e._v("Basta con ejecutar el comando "),o("code",[e._v("git remote -v")])]),e._v(" "),o("li",[e._v("Se mostrará las URL de los repositorios remotos configurados actualmente. La URL para la rama principal "),o("code",[e._v("origin")]),e._v(" debería ahora ser la URL SSH que acabamos de configurar.")])])])]),e._v(" "),o("p",[e._v("A partir de este momento, ya podemos continuar trabajando con Git como de costumbre.")]),e._v(" "),o("h2",{attrs:{id:"configuracion-de-la-clave-privada-ssh-en-sourcetree"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#configuracion-de-la-clave-privada-ssh-en-sourcetree"}},[e._v("#")]),e._v(" Configuración de la clave privada SSH en Sourcetree")]),e._v(" "),o("p",[e._v("Para configurar nuestra clave privada SSH en Sourcetree debemos seguir los siguientes pasos:")]),e._v(" "),o("ol",[o("li",[e._v("Abrimos Sourcetree.")]),e._v(" "),o("li",[e._v('Accedemos al panel de opciones de configuración mediante el menú "Tools" en la barra de menú superior y seleccionando "Options" en el menú desplegable.')]),e._v(" "),o("li",[e._v('Desde la pestaña "General", seleccionamos en la sección "SSH Client Configuration" la opción "OpenSSH" del desplegable "SSH Cliente".')]),e._v(" "),o("li",[e._v('También en la sección "SSH Client Configuration", hacemos clic en el botón "..." para agregar la clave privada SSH. Esto abrirá una ventana para seleccionar el archivo de clave privada que queremos usar.')]),e._v(" "),o("li",[e._v('Tras especificar la clave privada hacemos clic en el botón "OK" para guardar la configuración. Si la clave privada estuviera protegida con una frase de seguridad, se nos solicitará que la especifquemos en este paso.')])]),e._v(" "),o("p",[e._v("Una vez que hayas agregado la clave SSH en Sourcetree ya podemos usarla para conectarnos a los repositorios remotos que requieren autenticación SSH.")]),e._v(" "),o("h2",{attrs:{id:"configuracion-de-la-clave-privada-ssh-en-vscode"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#configuracion-de-la-clave-privada-ssh-en-vscode"}},[e._v("#")]),e._v(" Configuración de la clave privada SSH en VSCode")]),e._v(" "),o("p",[e._v("Una vez hayamos configurado nuestras claves SSH para ser usadas con proveedor de repositorios Git remoto (Bitbucket, GitHub u otros) y usadas éstas para la configuración o clonado de un repositorio (como hemos visto anteriormente), la próxima vez que nos conectemos desde VSCode al repositorio Git remoto, se usará de manera predeterminada SSH en nuestras conexiones, por lo que no debemos realizar ninguna configuración adicional específica en VSCode.")]),e._v(" "),o("p",[e._v("Lo único que podría ocurrir es que VSCode nos solicitara la frase de seguridad que hayamos establecido al generar nuestra clave privada, pero en ese caso podríamos configurar y hacer uso del "),o("em",[e._v("ssh-agent")]),e._v(" como hemos visto anteriormente y así evitar tener que introducir nuestra frase de seguridad en cada sincronización con nuestro repositorio Git remoto.")]),e._v(" "),o("hr"),e._v(" "),o("social-share",{staticClass:"social-share--footer"})],1)}),[],!1,null,null,null);a.default=r.exports}}]);